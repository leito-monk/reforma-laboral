<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Juego del Derrame</title>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700&family=Archivo+Black&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF4136; --accent: #FF851B; --gold: #FFD700; --bg: #0D0D0D;
            --bg-medium: #1A1A1A; --surface: #1F1F1F; --text: #E8E8E8; --text-light: #A0A0A0;
            --border: #333; --success: #2ECC40; --worker: #3498db; --informal: #9b59b6;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Work Sans', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }
        .screen { display: none !important; min-height: 100vh; padding: 1rem; }
        .screen.active { display: flex !important; flex-direction: column; }

        /* INICIO */
        #screen-inicio.active { align-items: center; justify-content: center; text-align: center; }
        .game-title { font-family: 'Archivo Black', sans-serif; font-size: clamp(2rem, 8vw, 4rem); background: linear-gradient(135deg, var(--gold), var(--accent), var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .game-subtitle { font-family: 'IBM Plex Mono', monospace; color: var(--text-light); margin-top: 0.5rem; }
        .drip-icon { font-size: 4rem; animation: drip 2s ease-in-out infinite; }
        @keyframes drip { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(10px); } }
        
        .start-form { background: var(--surface); padding: 2rem; border-radius: 12px; margin: 2rem 0; max-width: 400px; width: 100%; border: 2px solid var(--border); }
        .form-group { margin-bottom: 1.5rem; text-align: left; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--accent); }
        .form-group input { width: 100%; padding: 0.75rem; border: 2px solid var(--border); border-radius: 6px; background: var(--bg); color: var(--text); font-size: 1rem; }
        .form-group input:focus { outline: none; border-color: var(--gold); }
        .avatar-selector { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; }
        .avatar-option { font-size: 2rem; padding: 0.5rem; background: var(--bg); border: 3px solid var(--border); border-radius: 8px; cursor: pointer; transition: all 0.2s; text-align: center; }
        .avatar-option:hover { border-color: var(--accent); transform: scale(1.05); }
        .avatar-option.selected { border-color: var(--gold); box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); }
        
        .btn { font-family: 'Archivo Black', sans-serif; padding: 1rem 2rem; border: none; border-radius: 8px; cursor: pointer; transition: all 0.2s; text-transform: uppercase; letter-spacing: 0.05em; font-size: 1rem; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-primary { background: linear-gradient(135deg, var(--gold), var(--accent)); color: var(--bg); }
        .btn-primary:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4); }
        .btn-secondary { background: var(--surface); color: var(--text); border: 2px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent); }
        .btn-small { padding: 0.5rem 1rem; font-size: 0.8rem; }
        .btn-danger { background: var(--primary); color: white; }
        
        /* AYUDA */
        #screen-ayuda { max-width: 800px; margin: 0 auto; }
        .help-title { font-family: 'Archivo Black', sans-serif; font-size: 2rem; margin-bottom: 1.5rem; color: var(--gold); }
        .help-section { background: var(--surface); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid var(--accent); }
        .help-section h3 { color: var(--accent); margin-bottom: 0.75rem; }
        .help-section ul { margin-left: 1.5rem; margin-top: 0.5rem; color: var(--text-light); }
        .help-section li { margin-bottom: 0.5rem; }
        
        /* JUEGO */
        #screen-juego { max-width: 1400px; margin: 0 auto; }
        
        /* Ticker noticias */
        .news-ticker { background: var(--primary); color: white; padding: 0.5rem 0; overflow: hidden; margin: -1rem -1rem 1rem -1rem; }
        .ticker-content { display: flex; animation: ticker 30s linear infinite; white-space: nowrap; }
        .ticker-item { padding: 0 3rem; font-weight: 500; }
        @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        
        /* Header juego */
        .game-header { display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center; margin-bottom: 1rem; }
        .player-info { display: flex; align-items: center; gap: 0.75rem; }
        .player-avatar { font-size: 2.5rem; }
        .player-name { font-family: 'Archivo Black', sans-serif; color: var(--gold); }
        .player-title { font-size: 0.75rem; color: var(--text-light); }
        
        .turn-display { text-align: center; background: var(--surface); padding: 1rem 2rem; border-radius: 12px; }
        .turn-number { font-family: 'Archivo Black', sans-serif; font-size: 2rem; color: var(--accent); }
        .turn-label { font-size: 0.8rem; color: var(--text-light); }
        
        .capital-politico { text-align: right; }
        .capital-bar { background: var(--bg); height: 24px; border-radius: 12px; overflow: hidden; width: 150px; margin-left: auto; border: 2px solid var(--border); }
        .capital-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); transition: width 0.5s; }
        .capital-label { font-size: 0.75rem; color: var(--text-light); margin-top: 0.25rem; }
        
        /* Objetivo */
        .objective-bar { background: var(--surface); padding: 0.75rem 1rem; border-radius: 8px; margin-bottom: 1rem; display: flex; align-items: center; gap: 1rem; }
        .objective-label { font-size: 0.85rem; color: var(--text-light); }
        .objective-progress { flex: 1; background: var(--bg); height: 16px; border-radius: 8px; overflow: hidden; }
        .objective-fill { height: 100%; background: linear-gradient(90deg, var(--success), #27ae60); transition: width 0.5s; }
        .objective-text { font-family: 'IBM Plex Mono', monospace; font-size: 0.85rem; min-width: 120px; text-align: right; }
        
        /* Indicadores */
        .indicators-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; margin-bottom: 1rem; }
        .indicator { background: var(--surface); padding: 1rem; border-radius: 8px; border: 2px solid var(--border); position: relative; overflow: hidden; }
        .indicator.empresario { border-color: var(--gold); }
        .indicator.trabajadores { border-color: var(--worker); }
        .indicator.trabajadores.suffering { border-color: var(--primary); animation: danger-pulse 2s ease-in-out infinite; }
        .indicator.informales { border-color: var(--informal); }
        .indicator.informales.suffering { border-color: var(--primary); animation: danger-pulse 2s ease-in-out infinite; }
        .indicator-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
        .indicator-title { font-size: 0.85rem; }
        .indicator-value { font-family: 'Archivo Black', sans-serif; font-size: 1.3rem; }
        .indicator-bar { background: var(--bg); height: 12px; border-radius: 6px; overflow: hidden; position: relative; }
        .indicator-fill { height: 100%; border-radius: 6px; transition: width 0.5s; }
        .indicator-fill.gold { background: linear-gradient(90deg, var(--accent), var(--gold)); }
        .indicator-fill.blue { background: var(--worker); }
        .indicator-fill.purple { background: var(--informal); }
        .indicator-pain { font-size: 0.7rem; color: var(--primary); margin-top: 0.3rem; font-style: italic; min-height: 16px; }
        @keyframes danger-pulse { 0%, 100% { box-shadow: 0 0 0 rgba(255, 65, 54, 0); } 50% { box-shadow: 0 0 15px rgba(255, 65, 54, 0.5); } }
        
        /* Trabajadores visuales */
        .workers-display { background: var(--surface); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid var(--border); }
        .workers-title { font-size: 0.9rem; color: var(--primary); margin-bottom: 0.75rem; text-align: center; font-weight: 600; }
        .workers-grid { display: flex; justify-content: center; gap: 3px; flex-wrap: wrap; }
        .worker-icon { font-size: 1.3rem; transition: all 0.5s; display: inline-block; }
        .worker-icon.formal-happy { filter: none; }
        .worker-icon.formal-sad { filter: saturate(0.6) brightness(0.9); animation: subtle-shake 2s ease-in-out infinite; }
        .worker-icon.informal { filter: grayscale(0.5) brightness(0.8); opacity: 0.7; animation: fade-pulse 3s ease-in-out infinite; }
        .worker-icon.desempleado { filter: grayscale(1); opacity: 0.35; animation: sink 4s ease-in-out infinite; }
        .workers-legend { display: flex; justify-content: center; gap: 1rem; margin-top: 0.75rem; font-size: 0.75rem; color: var(--text-light); flex-wrap: wrap; }
        .workers-suffering-msg { text-align: center; font-size: 0.8rem; color: var(--primary); margin-top: 0.5rem; font-style: italic; min-height: 20px; }
        @keyframes subtle-shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-1px); } 75% { transform: translateX(1px); } }
        @keyframes fade-pulse { 0%, 100% { opacity: 0.7; } 50% { opacity: 0.4; } }
        @keyframes sink { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(2px); } }
        
        /* Layout principal */
        .game-main { display: grid; grid-template-columns: 1fr 350px; gap: 1rem; }
        
        /* Medidas */
        .measures-panel { background: var(--surface); padding: 1rem; border-radius: 8px; max-height: 500px; overflow-y: auto; }
        .measures-title { font-family: 'Archivo Black', sans-serif; font-size: 1rem; margin-bottom: 1rem; }
        .measure-card { background: var(--bg); border: 2px solid var(--border); border-radius: 8px; padding: 0.75rem; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.2s; }
        .measure-card:hover:not(.used):not(.locked) { border-color: var(--accent); transform: translateX(4px); }
        .measure-card.used { opacity: 0.4; cursor: not-allowed; border-color: var(--success); }
        .measure-card.locked { opacity: 0.3; cursor: not-allowed; }
        .measure-card.selected { border-color: var(--gold); background: rgba(255, 215, 0, 0.1); }
        .measure-category { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent); }
        .measure-name { font-weight: 600; font-size: 0.85rem; margin: 0.25rem 0; }
        .measure-effects { display: flex; gap: 0.4rem; flex-wrap: wrap; font-size: 0.7rem; font-family: 'IBM Plex Mono', monospace; }
        .effect { padding: 0.1rem 0.3rem; border-radius: 3px; background: var(--surface); }
        .effect.positive { color: var(--success); }
        .effect.negative { color: var(--primary); }
        .measure-cost { font-size: 0.7rem; color: var(--accent); margin-top: 0.25rem; }
        
        /* Panel derecho - eventos y acciones */
        .side-panel { display: flex; flex-direction: column; gap: 1rem; }
        
        .action-panel { background: var(--surface); padding: 1rem; border-radius: 8px; text-align: center; }
        .selected-measure { background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; min-height: 80px; display: flex; align-items: center; justify-content: center; }
        .selected-measure.empty { color: var(--text-light); font-style: italic; }
        
        .event-panel { background: var(--surface); padding: 1rem; border-radius: 8px; flex: 1; }
        .event-title { font-family: 'Archivo Black', sans-serif; font-size: 0.9rem; margin-bottom: 0.75rem; color: var(--accent); }
        .event-card { background: var(--bg); border-radius: 8px; padding: 1rem; text-align: center; border: 2px solid var(--border); min-height: 150px; display: flex; flex-direction: column; justify-content: center; }
        .event-card.positive { border-color: var(--success); }
        .event-card.negative { border-color: var(--primary); }
        .event-card.neutral { border-color: var(--accent); }
        .event-icon { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .event-name { font-weight: 600; margin-bottom: 0.5rem; }
        .event-desc { font-size: 0.8rem; color: var(--text-light); }
        .event-effect { font-family: 'IBM Plex Mono', monospace; font-size: 0.85rem; margin-top: 0.5rem; padding: 0.25rem 0.5rem; background: var(--surface); border-radius: 4px; display: inline-block; }
        
        /* Stats panel */
        .stats-panel { background: var(--surface); padding: 1rem; border-radius: 8px; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.8rem; }
        .stat-item { display: flex; justify-content: space-between; padding: 0.25rem 0; border-bottom: 1px solid var(--border); }
        .stat-value { font-family: 'IBM Plex Mono', monospace; }
        
        /* Modal Game Over / Victoria */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 1rem; }
        .modal-overlay.active { display: flex; }
        .modal-content { background: var(--surface); padding: 2rem; border-radius: 16px; max-width: 500px; width: 100%; text-align: center; border: 3px solid var(--gold); animation: modalIn 0.3s ease-out; }
        @keyframes modalIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-icon { font-size: 4rem; margin-bottom: 1rem; }
        .modal-title { font-family: 'Archivo Black', sans-serif; font-size: 1.8rem; margin-bottom: 0.5rem; }
        .modal-subtitle { color: var(--text-light); margin-bottom: 1.5rem; }
        .modal-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        .modal-stat { background: var(--bg); padding: 1rem; border-radius: 8px; }
        .modal-stat-value { font-family: 'Archivo Black', sans-serif; font-size: 1.5rem; }
        .modal-stat-label { font-size: 0.75rem; color: var(--text-light); }
        .modal-message { background: var(--bg); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; text-align: left; font-size: 0.9rem; line-height: 1.5; }
        .modal-buttons { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }

        @media (max-width: 900px) {
            .game-main { grid-template-columns: 1fr; }
            .game-header { grid-template-columns: 1fr; text-align: center; }
            .capital-bar { margin: 0 auto; }
            .indicators-row { grid-template-columns: 1fr; }
        }

        /* Bot√≥n Mute */
        .btn-mute { position: fixed; bottom: 1rem; right: 1rem; width: 50px; height: 50px; border-radius: 50%; font-size: 1.5rem; padding: 0; z-index: 100; display: flex; align-items: center; justify-content: center; background: var(--surface); border: 2px solid var(--border); cursor: pointer; transition: all 0.2s; }
        .btn-mute:hover { border-color: var(--accent); transform: scale(1.1); }
        .btn-mute.muted { opacity: 0.5; }

        /* Container */
        .container { width: 100%; padding: 0 1rem; margin: 0 auto; max-width: 1200px; }

        /* Footer */
        footer { background: var(--bg-medium); border-top: 3px solid var(--primary); margin-top: 3rem; }
        .footer-content { display: flex; flex-direction: column; align-items: center; gap: 2rem; padding: 3rem 1rem; }
        .profile-photo { width: 120px; height: 120px; border-radius: 50%; overflow: hidden; border: 3px solid var(--primary); background: var(--bg); }
        .profile-photo img { width: 100%; height: 100%; object-fit: cover; }
        .contact-info { text-align: center; }
        .contact-info h3 { margin-bottom: 0.5rem; color: var(--text); }
        .bio { color: var(--text-light); max-width: 600px; margin: 0 auto 1rem; line-height: 1.6; }
        .social-links { display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap; margin-top: 1rem; }
        .social-links a { color: var(--text-light); text-decoration: none; transition: color 0.2s; display: flex; align-items: center; gap: 0.3rem; }
        .social-links a:hover { color: var(--primary); }
        .footer-note { border-top: 1px solid var(--border); padding-top: 1.5rem; width: 100%; text-align: center; color: var(--text-light); font-size: 0.9rem; }
        .footer-note a { color: var(--accent); text-decoration: none; }
        .footer-note a:hover { text-decoration: underline; }
    </style>
</head>
<body>

    <!-- PANTALLA INICIO -->
    <div id="screen-inicio" class="screen active">
        <div class="drip-icon">üíß</div>
        <h1 class="game-title">El Juego del Derrame</h1>
        <p class="game-subtitle">Simulador de Reforma Laboral Argentina 2025</p>
        <div class="start-form">
            <div class="form-group">
                <label>Nombre de tu empresa</label>
                <input type="text" id="player-name-input" placeholder="Ej: Grupo Derramix S.A." maxlength="25">
            </div>
            <div class="form-group">
                <label>Tu avatar de CEO</label>
                <div class="avatar-selector">
                    <div class="avatar-option selected" data-avatar="ü¶à">ü¶à</div>
                    <div class="avatar-option" data-avatar="üé©">üé©</div>
                    <div class="avatar-option" data-avatar="üíº">üíº</div>
                    <div class="avatar-option" data-avatar="üè¶">üè¶</div>
                    <div class="avatar-option" data-avatar="üíé">üíé</div>
                    <div class="avatar-option" data-avatar="ü¶Ö">ü¶Ö</div>
                    <div class="avatar-option" data-avatar="üê∫">üê∫</div>
                    <div class="avatar-option" data-avatar="üëë">üëë</div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="startGame()" style="width: 100%;">¬°Empezar a Derramar!</button>
        </div>
        
        <div style="background: var(--surface); padding: 1.5rem; border-radius: 12px; margin: 2rem 0; max-width: 600px; border: 2px solid var(--border); text-align: left;">
            <h3 style="color: var(--accent); margin-bottom: 0.75rem; font-size: 1.1rem;">üìã Sobre la Reforma Laboral</h3>
            <p style="color: var(--text-light); font-size: 0.9rem; line-height: 1.6; margin-bottom: 1rem;">
                Este juego simula las 12 medidas clave de la Ley de Modernizaci√≥n Laboral propuesta en Argentina. 
                El an√°lisis completo muestra una transferencia de <strong style="color: var(--gold);">$21 billones anuales</strong> 
                desde trabajadores a la patronal, afectando a 12.5 millones de trabajadores registrados. 
                ¬øPodr√°s maximizar ganancias sin colapsar el sistema?
            </p>
            <div style="display: flex; justify-content: center;">
                <a href="https://leito-monk.github.io/reforma-laboral/" class="btn btn-secondary btn-small" style="text-decoration: none;">üìä Ver An√°lisis Completos</a>
            </div>
        </div>
        
        <button class="btn btn-secondary" onclick="showScreen('ayuda')">üìñ C√≥mo se juega</button>
        <p style="margin-top:2rem; font-size:0.7rem; color:var(--text-light);">Basado en el an√°lisis del Proyecto de Ley de Modernizaci√≥n Laboral 2025</p>
    </div>

    <!-- PANTALLA AYUDA -->
    <div id="screen-ayuda" class="screen">
        <button class="btn btn-secondary" onclick="showScreen('inicio')" style="margin-bottom:1.5rem;">‚Üê Volver</button>
        <h2 class="help-title">üìñ C√≥mo se juega</h2>
        <div class="help-section">
            <h3>üéØ Objetivo</h3>
            <p>Acumul√° <strong>$15 billones</strong> en ganancias antes de que el bienestar de los trabajadores llegue a 0% o te quedes sin Capital Pol√≠tico.</p>
        </div>
        <div class="help-section">
            <h3>üéÆ Mec√°nica por turnos</h3>
            <ul>
                <li>Cada turno eleg√≠s <strong>UNA medida</strong> de la reforma para activar</li>
                <li>La medida te da ganancias pero afecta a los trabajadores</li>
                <li>Despu√©s de cada turno aparece un <strong>EVENTO</strong> aleatorio</li>
                <li>Los eventos pueden beneficiarte o perjudicarte</li>
            </ul>
        </div>
        <div class="help-section">
            <h3>üìä Recursos</h3>
            <ul>
                <li><strong style="color:var(--gold);">üí∞ Ganancias:</strong> Tu objetivo. Lleg√° a $15B para ganar</li>
                <li><strong style="color:var(--accent);">üèõÔ∏è Capital Pol√≠tico:</strong> Se gasta con medidas impopulares. Si llega a 0, perd√©s</li>
                <li><strong style="color:var(--worker);">üë∑ Bienestar Formales:</strong> Si llega a 0%, colapso social = perd√©s</li>
                <li><strong style="color:var(--informal);">üîß Ingresos Informales:</strong> Caen en cascada cuando bajan los formales</li>
            </ul>
        </div>
        <div class="help-section">
            <h3>üë• Los trabajadores</h3>
            <p>Observ√° c√≥mo van cambiando: de formales felices üòä a formales tristes üòü, a informales üò∞, a desempleados üíÄ. El "derrame" en acci√≥n.</p>
        </div>
        <button class="btn btn-primary" onclick="showScreen('inicio')">¬°Entendido!</button>
    </div>

    <!-- PANTALLA JUEGO -->
    <div id="screen-juego" class="screen">
        <div class="news-ticker">
            <div class="ticker-content" id="ticker-content"></div>
        </div>

        <div class="game-header">
            <div class="player-info">
                <span class="player-avatar" id="game-avatar">ü¶à</span>
                <div>
                    <div class="player-name" id="game-player-name">Mi Empresa</div>
                    <div class="player-title">CEO & Modernizador</div>
                </div>
            </div>
            <div class="turn-display">
                <div class="turn-number" id="turn-number">1</div>
                <div class="turn-label">TURNO</div>
            </div>
            <div class="capital-politico">
                <div class="capital-bar"><div class="capital-fill" id="capital-fill" style="width:100%"></div></div>
                <div class="capital-label">üèõÔ∏è Capital Pol√≠tico: <span id="capital-value">100</span>%</div>
            </div>
        </div>

        <div class="objective-bar">
            <span class="objective-label">üéØ Meta:</span>
            <div class="objective-progress"><div class="objective-fill" id="objective-fill" style="width:0%"></div></div>
            <span class="objective-text"><span id="ganancias-actual">0</span> / $15B</span>
        </div>

        <div class="indicators-row">
            <div class="indicator empresario">
                <div class="indicator-header">
                    <span class="indicator-title">üí∞ Ganancias</span>
                    <span class="indicator-value" id="val-ganancias" style="color:var(--gold)">$0B</span>
                </div>
                <div class="indicator-bar"><div class="indicator-fill gold" id="bar-ganancias" style="width:0%"></div></div>
            </div>
            <div class="indicator trabajadores">
                <div class="indicator-header">
                    <span class="indicator-title">üë∑ Bienestar Formales</span>
                    <span class="indicator-value" id="val-formales" style="color:var(--worker)">100%</span>
                </div>
                <div class="indicator-bar"><div class="indicator-fill blue" id="bar-formales" style="width:100%"></div></div>
                <div class="indicator-pain" id="pain-formales"></div>
            </div>
            <div class="indicator informales">
                <div class="indicator-header">
                    <span class="indicator-title">üîß Ingresos Informales</span>
                    <span class="indicator-value" id="val-informales" style="color:var(--informal)">100%</span>
                </div>
                <div class="indicator-bar"><div class="indicator-fill purple" id="bar-informales" style="width:100%"></div></div>
                <div class="indicator-pain" id="pain-informales"></div>
            </div>
        </div>

        <div class="workers-display">
            <div class="workers-title">üë• Estado de los trabajadores (cada √≠cono = 500.000 personas)</div>
            <div class="workers-grid" id="workers-grid"></div>
            <div class="workers-legend">
                <span>üòä Formal OK</span>
                <span>üòüüò¢ Formal sufriendo</span>
                <span>üò∞üò≠ Informal</span>
                <span>üíÄ Sin futuro</span>
            </div>
            <div class="workers-suffering-msg" id="workers-suffering-msg"></div>
        </div>

        <div class="game-main">
            <div class="measures-panel">
                <div class="measures-title">üìã Medidas disponibles (eleg√≠ una)</div>
                <div id="medidas-list"></div>
            </div>

            <div class="side-panel">
                <div class="action-panel">
                    <div class="selected-measure empty" id="selected-measure">Seleccion√° una medida</div>
                    <button class="btn btn-primary" id="btn-aplicar" onclick="aplicarMedida()" disabled>‚ö° Aplicar Medida</button>
                    <button class="btn btn-secondary btn-small" onclick="skipTurn()" style="margin-top:0.5rem;">‚è≠Ô∏è Pasar turno (sin medida)</button>
                </div>

                <div class="event-panel">
                    <div class="event-title">üì∞ √öltimo evento</div>
                    <div class="event-card" id="event-card">
                        <div class="event-icon">üé¨</div>
                        <div class="event-name">Inicio del juego</div>
                        <div class="event-desc">La reforma est√° lista. ¬øQu√© medida aplicar√°s primero?</div>
                    </div>
                </div>

                <div class="stats-panel">
                    <div class="stats-grid">
                        <div class="stat-item"><span>Medidas usadas</span><span class="stat-value" id="stat-medidas">0/18</span></div>
                        <div class="stat-item"><span>Formalizados</span><span class="stat-value" id="stat-formalizados">0</span></div>
                        <div class="stat-item"><span>Transferido</span><span class="stat-value" id="stat-transferido">$0B</span></div>
                        <div class="stat-item"><span>P√©rdida/trabaj.</span><span class="stat-value" id="stat-perdida">$0</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL GAME OVER / VICTORIA -->
    <div class="modal-overlay" id="modal-overlay">

    <!-- BOT√ìN MUTE -->
    <button class="btn-mute" id="btn-mute" onclick="toggleMute()">üîä</button>
        <div class="modal-content">
            <div class="modal-icon" id="modal-icon">üèÜ</div>
            <h2 class="modal-title" id="modal-title">¬°Victoria!</h2>
            <p class="modal-subtitle" id="modal-subtitle">Nivel alcanzado</p>
            <div class="modal-stats">
                <div class="modal-stat"><div class="modal-stat-value" style="color:var(--gold)" id="modal-ganancias">$0B</div><div class="modal-stat-label">Ganancias</div></div>
                <div class="modal-stat"><div class="modal-stat-value" style="color:var(--primary)" id="modal-bienestar">0%</div><div class="modal-stat-label">Bienestar final</div></div>
                <div class="modal-stat"><div class="modal-stat-value" style="color:var(--success)" id="modal-formalizados">0</div><div class="modal-stat-label">Formalizados</div></div>
                <div class="modal-stat"><div class="modal-stat-value" id="modal-turnos">0</div><div class="modal-stat-label">Turnos</div></div>
            </div>
            <div class="modal-message" id="modal-message"></div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="reiniciarJuego()">üîÑ Jugar de nuevo</button>
                <button class="btn btn-secondary" onclick="window.open('https://leito-monk.github.io/reforma-laboral/')">üìä Ver informe real</button>
            </div>
        </div>
    </div>

<script>
// ============ AUDIO 8-BIT ============
let audioCtx = null;
let isMuted = false;
let musicInterval = null;

function initAudio() {
    if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    if (audioCtx.state === 'suspended') {
        audioCtx.resume();
    }
}

function playTone(freq, duration, type = 'square', volume = 0.15) {
    if (isMuted || !audioCtx) return;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = type;
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
    gain.gain.setValueAtTime(volume, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + duration);
}

function playSound(type) {
    if (isMuted) return;
    initAudio();
    
    switch(type) {
        case 'click':
            playTone(800, 0.05, 'square', 0.1);
            break;
        case 'coin':
            playTone(987, 0.1, 'square', 0.15);
            setTimeout(() => playTone(1318, 0.15, 'square', 0.15), 100);
            break;
        case 'apply':
            playTone(523, 0.08, 'square', 0.12);
            setTimeout(() => playTone(659, 0.08, 'square', 0.12), 80);
            setTimeout(() => playTone(784, 0.12, 'square', 0.12), 160);
            break;
        case 'negative':
            playTone(300, 0.15, 'sawtooth', 0.12);
            setTimeout(() => playTone(250, 0.2, 'sawtooth', 0.1), 150);
            break;
        case 'event':
            playTone(600, 0.08, 'triangle', 0.15);
            setTimeout(() => playTone(800, 0.08, 'triangle', 0.15), 100);
            break;
        case 'victory':
            const victoryNotes = [523, 659, 784, 1047];
            victoryNotes.forEach((note, i) => {
                setTimeout(() => playTone(note, 0.2, 'square', 0.15), i * 150);
            });
            break;
        case 'gameover':
            playTone(400, 0.3, 'sawtooth', 0.15);
            setTimeout(() => playTone(300, 0.3, 'sawtooth', 0.12), 300);
            setTimeout(() => playTone(200, 0.5, 'sawtooth', 0.1), 600);
            break;
        case 'select':
            playTone(440, 0.05, 'square', 0.08);
            break;
    }
}

// M√∫sica de fondo estilo chiptune
let musicPlaying = false;
const musicNotes = [
    262, 294, 330, 262, 330, 294, 262, 220,
    262, 294, 330, 349, 330, 294, 262, 247,
    262, 294, 330, 262, 392, 349, 330, 294,
    262, 330, 294, 262, 247, 220, 262, 262
];
let musicIndex = 0;

function startMusic() {
    if (musicPlaying || isMuted) return;
    initAudio();
    musicPlaying = true;
    musicInterval = setInterval(() => {
        if (isMuted) return;
        playTone(musicNotes[musicIndex], 0.15, 'triangle', 0.06);
        // Bass note
        playTone(musicNotes[musicIndex] / 2, 0.15, 'triangle', 0.04);
        musicIndex = (musicIndex + 1) % musicNotes.length;
    }, 250);
}

function stopMusic() {
    musicPlaying = false;
    if (musicInterval) {
        clearInterval(musicInterval);
        musicInterval = null;
    }
}

function toggleMute() {
    isMuted = !isMuted;
    const btn = document.getElementById('btn-mute');
    btn.textContent = isMuted ? 'üîá' : 'üîä';
    btn.classList.toggle('muted', isMuted);
    
    if (isMuted) {
        stopMusic();
    } else if (document.getElementById('screen-juego').classList.contains('active')) {
        startMusic();
    }
    playSound('click');
}

// ============ DATOS ============
const MEDIDAS = [
    // RETROCESOS (12)
    { id:'r1', cat:'RETROCESO', nombre:'Eliminaci√≥n presunci√≥n laboral', desc:'Factura elimina presunci√≥n', ganancia:2.82, bienestar:-5, capital:-8, formal:0 },
    { id:'r2', cat:'RETROCESO', nombre:'Banco de horas', desc:'Adi√≥s 50% extra por horas', ganancia:2.48, bienestar:-5, capital:-5, formal:0 },
    { id:'r3', cat:'RETROCESO', nombre:'Base c√°lculo reducida', desc:'Excluye SAC (-17% indem.)', ganancia:2.34, bienestar:-4, capital:-4, formal:0 },
    { id:'r4', cat:'RETROCESO', nombre:'Tope indemnizatorio 3x', desc:'L√≠mite a indemnizaciones', ganancia:2.06, bienestar:-4, capital:-6, formal:0 },
    { id:'r5', cat:'RETROCESO', nombre:'Limitar solidaridad tercerizaci√≥n', desc:'Principal se libera', ganancia:1.58, bienestar:-3, capital:-4, formal:0 },
    { id:'r6', cat:'RETROCESO', nombre:'Per√≠odo prueba sin preaviso', desc:'Despido libre', ganancia:1.32, bienestar:-3, capital:-3, formal:0 },
    { id:'r7', cat:'RETROCESO', nombre:'Fondo de cese opcional', desc:'Empleador decide', ganancia:1.20, bienestar:-2, capital:-5, formal:0 },
    { id:'r8', cat:'RETROCESO', nombre:'Solidaridad solo con fraude', desc:'Carga en trabajador', ganancia:0.95, bienestar:-2, capital:-3, formal:0 },
    { id:'r9', cat:'RETROCESO', nombre:'Extinci√≥n por silencio', desc:'2 meses = fin contrato', ganancia:0.88, bienestar:-3, capital:-4, formal:0 },
    { id:'r10', cat:'RETROCESO', nombre:'Pluspetici√≥n inexcusable', desc:'Trabajador paga costas', ganancia:0.75, bienestar:-2, capital:-6, formal:0 },
    { id:'r11', cat:'RETROCESO', nombre:'Reducci√≥n salarial incapacidad', desc:'Hasta -40% salario', ganancia:0.65, bienestar:-2, capital:-5, formal:0 },
    { id:'r12', cat:'RETROCESO', nombre:'Vacaciones fraccionables', desc:'M√≠nimo 7 d√≠as', ganancia:0.45, bienestar:-1, capital:-2, formal:0 },
    // FISCALES (6)
    { id:'f1', cat:'FISCAL', nombre:'Reducci√≥n contrib. patronales', desc:'20,4%‚Üí17,4%', ganancia:3.25, bienestar:0, capital:-3, formal:8000 },
    { id:'f2', cat:'FISCAL', nombre:'RIFL nuevo empleo', desc:'Contrib. al 2% x48 meses', ganancia:0.80, bienestar:0, capital:+5, formal:5000 },
    { id:'f3', cat:'FISCAL', nombre:'Baja Ganancias corporativo', desc:'30%‚Üí27%', ganancia:1.30, bienestar:0, capital:-2, formal:2000 },
    { id:'f4', cat:'FISCAL', nombre:'Eliminar Imp. Internos', desc:'Seguros, telefon√≠a...', ganancia:0.65, bienestar:0, capital:-1, formal:500 },
    { id:'f5', cat:'FISCAL', nombre:'RIMI inversiones', desc:'Amortizaci√≥n acelerada', ganancia:0.20, bienestar:0, capital:+2, formal:300 },
    { id:'f6', cat:'FISCAL', nombre:'Blanqueo laboral PER', desc:'Condonaci√≥n 70% deuda', ganancia:0.15, bienestar:0, capital:+3, formal:200 }
];

const EVENTOS = [
    // Negativos - sufrimiento expl√≠cito
    { icon:'üì¢', nombre:'Paro general', desc:'Los sindicatos responden con bronca', efecto:'capital', valor:-15, tipo:'negative', mensaje:'Miles en las calles: "No somos descartables"' },
    { icon:'‚öñÔ∏è', nombre:'Juicio colectivo', desc:'Demanda masiva de trabajadores precarizados', efecto:'ganancias', valor:-0.8, tipo:'negative', mensaje:'"Nos quitaron todo, ahora vamos por justicia"' },
    { icon:'üì∫', nombre:'Esc√°ndalo medi√°tico', desc:'C√°mara oculta muestra explotaci√≥n', efecto:'capital', valor:-20, tipo:'negative', mensaje:'"Trabajan 12 horas sin descanso ni comida"' },
    { icon:'üö™', nombre:'Fuga de talentos', desc:'Los mejores huyen de la precarizaci√≥n', efecto:'ganancias', valor:-0.5, tipo:'negative', mensaje:'"Preferimos ganar menos pero dignamente"' },
    { icon:'üî•', nombre:'Conflicto en planta', desc:'Trabajadores al borde del quiebre', efecto:'bienestar', valor:-5, tipo:'negative', mensaje:'"Ya no podemos m√°s con esta presi√≥n"' },
    { icon:'üìâ', nombre:'Ca√≠da de productividad', desc:'Desmotivaci√≥n y agotamiento extremo', efecto:'ganancias', valor:-0.6, tipo:'negative', mensaje:'"Sin derechos, sin ganas de dar m√°s"' },
    { icon:'üè•', nombre:'Accidente laboral grave', desc:'Sin protecciones adecuadas', efecto:'capital', valor:-12, tipo:'negative', mensaje:'"La precarizaci√≥n mata, literalmente"' },
    { icon:'üì∞', nombre:'Investigaci√≥n period√≠stica', desc:'Exponen condiciones inhumanas', efecto:'capital', valor:-18, tipo:'negative', mensaje:'"Duermen en el piso, comen una vez al d√≠a"' },
    { icon:'üò¢', nombre:'Trabajador se suicida', desc:'La presi√≥n laboral fue demasiado', efecto:'capital', valor:-25, tipo:'negative', mensaje:'"Dej√≥ una carta: no aguantaba m√°s la incertidumbre"' },
    { icon:'üë®‚Äçüë©‚Äçüëß', nombre:'Familias destruidas', desc:'Padres sin tiempo ni dinero para sus hijos', efecto:'bienestar', valor:-6, tipo:'negative', mensaje:'"Los chicos ya no me reconocen, siempre trabajo"' },
    { icon:'üçû', nombre:'Hambre en aumento', desc:'Salarios no alcanzan para comer', efecto:'bienestar', valor:-4, tipo:'negative', mensaje:'"Comemos una vez por d√≠a para que alcance"' },
    { icon:'üíä', nombre:'Crisis de salud mental', desc:'Ansiedad y depresi√≥n masiva', efecto:'bienestar', valor:-5, tipo:'negative', mensaje:'"Sin obra social, sin terapia, sin esperanza"' },
    // Positivos
    { icon:'üìà', nombre:'Nota en La Naci√≥n', desc:'"Empresario modelo"', efecto:'capital', valor:+10, tipo:'positive' },
    { icon:'ü§ù', nombre:'Acuerdo con sindicato', desc:'Negociaci√≥n exitosa', efecto:'capital', valor:+8, tipo:'positive' },
    { icon:'üíπ', nombre:'Boom de exportaciones', desc:'El mercado te favorece', efecto:'ganancias', valor:+0.7, tipo:'positive' },
    { icon:'üèÜ', nombre:'Premio a la innovaci√≥n', desc:'Reconocimiento empresarial', efecto:'capital', valor:+12, tipo:'positive' },
    { icon:'üìä', nombre:'Informe favorable', desc:'Consultora te elogia', efecto:'capital', valor:+6, tipo:'positive' },
    { icon:'üí∞', nombre:'Subsidio estatal', desc:'El gobierno te ayuda', efecto:'ganancias', valor:+0.4, tipo:'positive' },
    // Neutros
    { icon:'üóûÔ∏è', nombre:'Declaraci√≥n oficialista', desc:'"La reforma crea empleo"', efecto:'nada', valor:0, tipo:'neutral' },
    { icon:'ü§∑', nombre:'Encuesta ambigua', desc:'50% a favor, 50% en contra', efecto:'nada', valor:0, tipo:'neutral' },
    { icon:'üìã', nombre:'Nuevo tr√°mite burocr√°tico', desc:'AFIP suma formularios', efecto:'nada', valor:0, tipo:'neutral' },
    { icon:'üéôÔ∏è', nombre:'Economista en TV', desc:'"Ya viene el derrame"', efecto:'nada', valor:0, tipo:'neutral' }
];

const TITULARES = [
    'üì∞ "La modernizaci√≥n laboral generar√° millones de empleos" - Vocero oficial',
    'üì∫ Economista: "El derrame es cuesti√≥n de tiempo, hay que esperar"',
    'üì∞ C√°mara empresaria celebra "nuevo clima de negocios"',
    'üì∫ "Los trabajadores deben adaptarse al siglo XXI" - Editorial',
    'üì∞ Informe privado: "Flexibilizaci√≥n warming up the economy"',
    'üì∫ "Antes los empresarios no pod√≠an contratar, ahora s√≠" - Ministro',
    'üì∞ CAME: "Pymes listas para crear empleo genuino"',
    'üì∫ "El problema era la rigidez, no los salarios" - Analista',
    'üì∞ R√©cord de blanqueo: 200 trabajadores regularizados',
    'üì∫ "El goteo ya empez√≥" afirma consultor econ√≥mico',
    'üì∞ UIA: "Hac√≠an falta estas reformas desde hace 50 a√±os"',
    'üì∫ Encuesta: 47% cree que la reforma crear√° empleo',
    'üì∞ "Los sindicatos no entienden la econom√≠a moderna" - Columnista',
    'üì∫ FMI elogia reformas estructurales argentinas',
    'üì∞ "El mercado laboral necesitaba un shock" - Empresario del a√±o'
];

// ============ ESTADO ============
let estado = {
    turno: 1,
    ganancias: 0,
    bienestar: 100,
    informal: 100,
    capital: 100,
    formalizados: 0,
    medidasUsadas: [],
    medidaSeleccionada: null,
    playerName: 'Mi Empresa',
    playerAvatar: 'ü¶à',
    juegoTerminado: false
};

const META_GANANCIAS = 15;
const TOTAL_TRABAJADORES = 25; // √≠conos visuales

// ============ FUNCIONES UI ============
let pantallaAnterior = 'inicio';

function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById('screen-'+id).classList.add('active');
    pantallaAnterior = id;
}

document.querySelectorAll('.avatar-option').forEach(opt => {
    opt.addEventListener('click', () => {
        document.querySelectorAll('.avatar-option').forEach(o => o.classList.remove('selected'));
        opt.classList.add('selected');
        estado.playerAvatar = opt.dataset.avatar;
    });
});

function startGame() {
    initAudio();
    playSound('apply');
    const nombre = document.getElementById('player-name-input').value.trim();
    estado = {
        turno: 1,
        ganancias: 0,
        bienestar: 100,
        informal: 100,
        capital: 100,
        formalizados: 0,
        medidasUsadas: [],
        medidaSeleccionada: null,
        playerName: nombre || 'Grupo Derramix S.A.',
        playerAvatar: document.querySelector('.avatar-option.selected')?.dataset.avatar || 'ü¶à',
        juegoTerminado: false
    };
    document.getElementById('game-player-name').textContent = estado.playerName;
    document.getElementById('game-avatar').textContent = estado.playerAvatar;
    initTicker();
    renderMedidas();
    renderWorkers();
    actualizarUI();
    showScreen('juego');
    setTimeout(() => startMusic(), 500);
}

function initTicker() {
    const ticker = document.getElementById('ticker-content');
    let html = '';
    const shuffled = TITULARES.sort(() => Math.random() - 0.5);
    for (let i = 0; i < 3; i++) {
        shuffled.forEach(t => { html += `<span class="ticker-item">${t}</span>`; });
    }
    ticker.innerHTML = html;
}

function renderMedidas() {
    const container = document.getElementById('medidas-list');
    container.innerHTML = '';
    MEDIDAS.forEach(m => {
        const usado = estado.medidasUsadas.includes(m.id);
        const selected = estado.medidaSeleccionada === m.id;
        let efectos = `<span class="effect positive">+$${m.ganancia}B</span>`;
        if (m.bienestar < 0) efectos += `<span class="effect negative">${m.bienestar}% bien.</span>`;
        if (m.capital < 0) efectos += `<span class="effect negative">${m.capital} cap.</span>`;
        if (m.capital > 0) efectos += `<span class="effect positive">+${m.capital} cap.</span>`;
        if (m.formal > 0) efectos += `<span class="effect positive">+${m.formal.toLocaleString()} form.</span>`;
        
        container.innerHTML += `
            <div class="measure-card ${usado ? 'used' : ''} ${selected ? 'selected' : ''}" 
                 data-id="${m.id}" onclick="seleccionarMedida('${m.id}')">
                <div class="measure-category">${m.cat}</div>
                <div class="measure-name">${m.nombre}</div>
                <div class="measure-effects">${efectos}</div>
            </div>
        `;
    });
}

function renderWorkers() {
    const grid = document.getElementById('workers-grid');
    const sufferingMsg = document.getElementById('workers-suffering-msg');
    let html = '';
    const pctFormal = estado.bienestar;
    const pctInformal = estado.informal;
    
    let happyCount = 0, sadCount = 0, informalCount = 0, unemployedCount = 0;
    
    for (let i = 0; i < TOTAL_TRABAJADORES; i++) {
        const pct = (i / TOTAL_TRABAJADORES) * 100;
        let clase, emoji;
        if (pct < pctFormal * 0.6) {
            clase = 'formal-happy'; emoji = 'üòä'; happyCount++;
        } else if (pct < pctFormal * 0.85) {
            clase = 'formal-sad'; emoji = 'üòü'; sadCount++;
        } else if (pct < pctFormal) {
            clase = 'formal-sad'; emoji = 'üò¢'; sadCount++;
        } else if (pct < pctFormal + (100 - pctFormal) * (pctInformal / 100) * 0.4) {
            clase = 'informal'; emoji = 'üò∞'; informalCount++;
        } else if (pct < pctFormal + (100 - pctFormal) * (pctInformal / 100)) {
            clase = 'informal'; emoji = 'üò≠'; informalCount++;
        } else {
            clase = 'desempleado'; emoji = 'üíÄ'; unemployedCount++;
        }
        html += `<span class="worker-icon ${clase}">${emoji}</span>`;
    }
    grid.innerHTML = html;
    
    // Mensaje de sufrimiento
    let mensaje = '';
    if (unemployedCount > 5) {
        mensaje = `${unemployedCount} trabajadores sin futuro üíÄ`;
    } else if (informalCount > 8) {
        mensaje = `${informalCount} en la informalidad, sin protecci√≥n üò≠`;
    } else if (sadCount > 7) {
        mensaje = `${sadCount} trabajadores formales sufriendo precarizaci√≥n üò¢`;
    } else if (sadCount > 0) {
        mensaje = `Los primeros ${sadCount} ya sienten el impacto... üòü`;
    }
    if (sufferingMsg) sufferingMsg.textContent = mensaje;
}

function seleccionarMedida(id) {
    if (estado.medidasUsadas.includes(id) || estado.juegoTerminado) return;
    playSound('select');
    estado.medidaSeleccionada = id;
    renderMedidas();
    const medida = MEDIDAS.find(m => m.id === id);
    document.getElementById('selected-measure').innerHTML = `<strong>${medida.nombre}</strong>`;
    document.getElementById('selected-measure').classList.remove('empty');
    document.getElementById('btn-aplicar').disabled = false;
}

function actualizarUI() {
    document.getElementById('turn-number').textContent = estado.turno;
    document.getElementById('capital-fill').style.width = estado.capital + '%';
    document.getElementById('capital-value').textContent = estado.capital;
    
    document.getElementById('val-ganancias').textContent = '$' + estado.ganancias.toFixed(1) + 'B';
    document.getElementById('bar-ganancias').style.width = (estado.ganancias / META_GANANCIAS * 100) + '%';
    document.getElementById('ganancias-actual').textContent = '$' + estado.ganancias.toFixed(1) + 'B';
    document.getElementById('objective-fill').style.width = Math.min(estado.ganancias / META_GANANCIAS * 100, 100) + '%';
    
    document.getElementById('val-formales').textContent = Math.max(0, estado.bienestar) + '%';
    document.getElementById('bar-formales').style.width = Math.max(0, estado.bienestar) + '%';
    
    // Mensajes de dolor en indicadores
    const formalIndicator = document.querySelector('.indicator.trabajadores');
    const painFormal = document.getElementById('pain-formales');
    if (estado.bienestar < 30) {
        formalIndicator.classList.add('suffering');
        painFormal.textContent = 'üíî Colapso inminente';
    } else if (estado.bienestar < 50) {
        formalIndicator.classList.add('suffering');
        painFormal.textContent = 'üò¢ Sufrimiento extremo';
    } else if (estado.bienestar < 70) {
        painFormal.textContent = 'üòü Precarizaci√≥n creciente';
    } else if (estado.bienestar < 90) {
        painFormal.textContent = 'üòï Empiezan a sentirlo';
    } else {
        formalIndicator.classList.remove('suffering');
        painFormal.textContent = '';
    }
    
    // Cascada: informales caen cuando formales caen
    estado.informal = Math.max(0, 100 - (100 - estado.bienestar) * 0.6);
    document.getElementById('val-informales').textContent = Math.round(estado.informal) + '%';
    document.getElementById('bar-informales').style.width = estado.informal + '%';
    
    const informalIndicator = document.querySelector('.indicator.informales');
    const painInformal = document.getElementById('pain-informales');
    if (estado.informal < 40) {
        informalIndicator.classList.add('suffering');
        painInformal.textContent = 'üíÄ Pobreza extrema';
    } else if (estado.informal < 60) {
        informalIndicator.classList.add('suffering');
        painInformal.textContent = 'üò≠ Crisis de ingresos';
    } else if (estado.informal < 80) {
        painInformal.textContent = 'üò∞ Efecto cascada';
    } else {
        informalIndicator.classList.remove('suffering');
        painInformal.textContent = '';
    }
    
    document.getElementById('stat-medidas').textContent = estado.medidasUsadas.length + '/18';
    document.getElementById('stat-formalizados').textContent = estado.formalizados.toLocaleString();
    document.getElementById('stat-transferido').textContent = '$' + estado.ganancias.toFixed(1) + 'B';
    const perdidaUnit = Math.round((100 - estado.bienestar) / 100 * 1700000);
    document.getElementById('stat-perdida').textContent = '$' + perdidaUnit.toLocaleString();
    
    renderWorkers();
}

// ============ L√ìGICA DEL JUEGO ============
function aplicarMedida() {
    if (!estado.medidaSeleccionada || estado.juegoTerminado) return;
    
    const medida = MEDIDAS.find(m => m.id === estado.medidaSeleccionada);
    estado.medidasUsadas.push(medida.id);
    
    // Sonidos seg√∫n efecto
    playSound('apply');
    if (medida.ganancia > 1) {
        setTimeout(() => playSound('coin'), 200);
    }
    if (medida.bienestar < -3) {
        setTimeout(() => playSound('negative'), 400);
    }
    
    // Aplicar efectos
    estado.ganancias = Math.max(0, estado.ganancias + medida.ganancia);
    estado.bienestar = Math.max(0, estado.bienestar + medida.bienestar);
    estado.capital = Math.max(0, Math.min(100, estado.capital + medida.capital));
    estado.formalizados += medida.formal;
    
    // Reset selecci√≥n
    estado.medidaSeleccionada = null;
    document.getElementById('selected-measure').innerHTML = 'Seleccion√° una medida';
    document.getElementById('selected-measure').classList.add('empty');
    document.getElementById('btn-aplicar').disabled = true;
    
    actualizarUI();
    renderMedidas();
    
    // Chequear condiciones de fin
    if (checkFinJuego()) return;
    
    // Evento aleatorio
    setTimeout(() => {
        ejecutarEvento();
        estado.turno++;
        actualizarUI();
        checkFinJuego();
    }, 500);
}

function skipTurn() {
    if (estado.juegoTerminado) return;
    playSound('click');
    estado.medidaSeleccionada = null;
    document.getElementById('selected-measure').innerHTML = 'Seleccion√° una medida';
    document.getElementById('selected-measure').classList.add('empty');
    document.getElementById('btn-aplicar').disabled = true;
    
    // Peque√±a penalizaci√≥n por no hacer nada
    estado.capital = Math.min(100, estado.capital + 2); // recupera un poco de capital
    
    setTimeout(() => {
        ejecutarEvento();
        estado.turno++;
        actualizarUI();
        checkFinJuego();
    }, 300);
}

function ejecutarEvento() {
    const evento = EVENTOS[Math.floor(Math.random() * EVENTOS.length)];
    const card = document.getElementById('event-card');
    
    playSound('event');
    if (evento.tipo === 'negative') {
        setTimeout(() => playSound('negative'), 300);
    } else if (evento.tipo === 'positive') {
        setTimeout(() => playSound('coin'), 300);
    }
    
    card.className = 'event-card ' + evento.tipo;
    
    let efectoTexto = '';
    if (evento.efecto === 'ganancias') {
        estado.ganancias = Math.max(0, estado.ganancias + evento.valor);
        efectoTexto = (evento.valor >= 0 ? '+' : '') + evento.valor.toFixed(1) + 'B ganancias';
    } else if (evento.efecto === 'capital') {
        estado.capital = Math.max(0, Math.min(100, estado.capital + evento.valor));
        efectoTexto = (evento.valor >= 0 ? '+' : '') + evento.valor + ' capital pol√≠tico';
    } else if (evento.efecto === 'bienestar') {
        estado.bienestar = Math.max(0, Math.min(100, estado.bienestar + evento.valor));
        efectoTexto = (evento.valor >= 0 ? '+' : '') + evento.valor + '% bienestar';
    } else {
        efectoTexto = 'Sin efecto directo';
    }
    
    let mensajeExtra = evento.mensaje ? `<div style="font-size:0.75rem; margin-top:0.5rem; padding:0.5rem; background:var(--surface); border-radius:4px; font-style:italic; color:var(--primary);">"${evento.mensaje}"</div>` : '';
    
    card.innerHTML = `
        <div class="event-icon">${evento.icon}</div>
        <div class="event-name">${evento.nombre}</div>
        <div class="event-desc">${evento.desc}</div>
        <div class="event-effect">${efectoTexto}</div>
        ${mensajeExtra}
    `;
}

function checkFinJuego() {
    if (estado.juegoTerminado) return true;
    
    // Victoria
    if (estado.ganancias >= META_GANANCIAS) {
        estado.juegoTerminado = true;
        mostrarFinal('victoria');
        return true;
    }
    
    // Derrota por capital
    if (estado.capital <= 0) {
        estado.juegoTerminado = true;
        mostrarFinal('derrota-capital');
        return true;
    }
    
    // Derrota por colapso social
    if (estado.bienestar <= 0) {
        estado.juegoTerminado = true;
        mostrarFinal('derrota-social');
        return true;
    }
    
    // Sin medidas disponibles
    if (estado.medidasUsadas.length >= MEDIDAS.length) {
        estado.juegoTerminado = true;
        mostrarFinal('sin-medidas');
        return true;
    }
    
    return false;
}

function mostrarFinal(tipo) {
    stopMusic();
    const modal = document.getElementById('modal-overlay');
    let icon, title, subtitle, mensaje;
    
    // Sonido seg√∫n resultado
    if (tipo === 'victoria') {
        playSound('victory');
    } else {
        playSound('gameover');
    }
    
    document.getElementById('modal-ganancias').textContent = '$' + estado.ganancias.toFixed(1) + 'B';
    document.getElementById('modal-bienestar').textContent = Math.max(0, estado.bienestar) + '%';
    document.getElementById('modal-formalizados').textContent = estado.formalizados.toLocaleString();
    document.getElementById('modal-turnos').textContent = estado.turno;
    
    const trabajadoresAfectados = Math.round((100 - estado.bienestar) / 100 * 12500000);
    const perdidaAnualPorPersona = Math.round((100 - estado.bienestar) / 100 * 1700000);
    
    if (tipo === 'victoria') {
        icon = 'üèÜ';
        title = '¬°GANASTE!';
        subtitle = 'Maestro del Derrame';
        const pctBienestar = estado.bienestar;
        if (pctBienestar > 70) {
            mensaje = `<p>¬°Incre√≠ble ${estado.playerName}! Llegaste a $${estado.ganancias.toFixed(1)}B manteniendo el bienestar en ${pctBienestar}%.</p>
            <p style="color:var(--primary); font-weight:600;">Pero en la realidad, ${trabajadoresAfectados.toLocaleString()} trabajadores perdieron derechos laborales. Cada uno pierde $${perdidaAnualPorPersona.toLocaleString()} al a√±o.</p>
            <p style="color:var(--accent)">Para que cierre la cuenta har√≠an falta 2.200.000 empleos nuevos formales. Vos "creaste" ${estado.formalizados.toLocaleString()}. La brecha: ${(2200000 - estado.formalizados).toLocaleString()} trabajadores.</p>
            <p style="font-size:0.85rem; margin-top:1rem;">üíÄ El derrame en la realidad: familias que no llegan a fin de mes, ni√±os que pasan hambre, trabajadores sin obra social.</p>`;
        } else if (pctBienestar > 40) {
            mensaje = `<p>${estado.playerName}, lo lograste pero a qu√© costo. Bienestar en ${pctBienestar}%.</p>
            <p style="color:var(--primary); font-weight:600;">${trabajadoresAfectados.toLocaleString()} trabajadores sufren precarizaci√≥n extrema. Perdieron $${perdidaAnualPorPersona.toLocaleString()} cada uno por a√±o en derechos y protecciones.</p>
            <p>Ganaste $${estado.ganancias.toFixed(1)}B para tu empresa, pero:</p>
            <ul style="text-align:left; margin-top:0.5rem; color:var(--text-light);">
                <li>üè• Millones sin obra social adecuada</li>
                <li>üçû Familias que saltean comidas</li>
                <li>üìö Ni√±os que abandonan la escuela</li>
                <li>üíî Parejas que se separan por la crisis econ√≥mica</li>
            </ul>
            <p style="color:var(--accent); margin-top:1rem;">El derrame funcion√≥... para vos. Para ellos, solo l√°grimas. üíß</p>`;
        } else {
            mensaje = `<p>Ganaste ${estado.playerName}, pero dejaste tierra arrasada. Bienestar en ${pctBienestar}%.</p>
            <p style="color:var(--primary); font-weight:600; font-size:1.1rem;">üíÄ ${trabajadoresAfectados.toLocaleString()} trabajadores destruidos. P√©rdida promedio: $${perdidaAnualPorPersona.toLocaleString()}/a√±o.</p>
            <p>Los informales tambi√©n la sintieron: sus ingresos cayeron ${Math.round(100-estado.informal)}% en cascada.</p>
            <div style="background:var(--bg); padding:1rem; border-radius:8px; margin-top:1rem; border-left:4px solid var(--primary);">
                <p style="font-weight:600; margin-bottom:0.5rem;">El costo humano real:</p>
                <ul style="text-align:left; color:var(--text-light); font-size:0.85rem;">
                    <li>üò¢ Trabajadores de 50+ a√±os sin chance de reinsertarse</li>
                    <li>üíä Aumento de enfermedades por estr√©s y malnutrici√≥n</li>
                    <li>üö™ Desalojos por no poder pagar alquiler</li>
                    <li>üèöÔ∏è Villas miseria creciendo sin control</li>
                    <li>üò∞ Tasa de suicidios en aumento</li>
                </ul>
            </div>
            <p style="color:var(--primary); font-weight:600; margin-top:1rem;">¬øVali√≥ la pena? Para vos s√≠: $${estado.ganancias.toFixed(1)}B. Para el resto... un infierno. üíÄ</p>`;
        }
    } else if (tipo === 'derrota-capital') {
        icon = 'üèõÔ∏èüí•';
        title = 'GAME OVER';
        subtitle = 'Sin Capital Pol√≠tico';
        mensaje = `<p>Te quedaste sin capital pol√≠tico, ${estado.playerName}. Las medidas fueron demasiado impopulares.</p>
        <p style="color:var(--primary); font-weight:600;">Pero antes de caer, ${trabajadoresAfectados.toLocaleString()} trabajadores ya sufrieron tu reforma. P√©rdida promedio: $${perdidaAnualPorPersona.toLocaleString()}/a√±o.</p>
        <p>Acumulaste $${estado.ganancias.toFixed(1)}B pero la presi√≥n social te sac√≥ del juego.</p>
        <div style="background:var(--bg); padding:1rem; border-radius:8px; margin-top:1rem;">
            <p style="color:var(--text-light); font-size:0.9rem;">Las calles se llenaron de protestas. Los sindicatos paralizaron el pa√≠s. Las familias destruidas exigieron justicia. Ya era tarde, pero al menos te frenaron.</p>
        </div>
        <p style="color:var(--accent); margin-top:1rem;">Moraleja: incluso en la ficci√≥n, la precarizaci√≥n tiene l√≠mites pol√≠ticos.</p>`;
    } else if (tipo === 'derrota-social') {
        icon = 'üíÄ';
        title = 'COLAPSO SOCIAL';
        subtitle = 'Bienestar en 0%';
        mensaje = `<p style="color:var(--primary); font-size:1.2rem; font-weight:700;">Destruiste ${trabajadoresAfectados.toLocaleString()} vidas, ${estado.playerName}.</p>
        <p>El bienestar lleg√≥ a 0%. Colapso total de la sociedad.</p>
        <div style="background:var(--bg); padding:1rem; border-radius:8px; margin-top:1rem; border-left:4px solid var(--primary);">
            <p style="font-weight:600; margin-bottom:0.5rem; color:var(--primary);">Lo que dejaste atr√°s:</p>
            <ul style="text-align:left; color:var(--text-light); font-size:0.85rem;">
                <li>üíÄ Trabajadores sin derechos, sin dignidad, sin esperanza</li>
                <li>üèöÔ∏è Familias viviendo en la calle</li>
                <li>üò¢ Una generaci√≥n perdida de ni√±os sin educaci√≥n ni salud</li>
                <li>üî• Tensi√≥n social al borde de la explosi√≥n</li>
                <li>üíî El tejido social completamente destruido</li>
            </ul>
        </div>
        <p style="margin-top:1rem;">Acumulaste $${estado.ganancias.toFixed(1)}B pero ya no hay trabajadores en condiciones de producir. No hay econom√≠a sin personas.</p>
        <p style="color:var(--primary); font-weight:600; font-size:1.1rem; margin-top:1rem;">El derrame no lleg√≥. Solo qued√≥ el desierto y el sufrimiento. üèúÔ∏èüíÄ</p>`;
    } else {
        icon = 'üìã';
        title = 'SIN MEDIDAS';
        subtitle = 'Usaste todas las reformas';
        const gano = estado.ganancias >= META_GANANCIAS;
        if (gano) {
            mensaje = `<p>Usaste todas las medidas y llegaste a la meta. ¬°${estado.playerName} lo logr√≥!</p>
            <p style="color:var(--primary); font-weight:600;">Costo: ${trabajadoresAfectados.toLocaleString()} trabajadores precarizados. P√©rdida promedio: $${perdidaAnualPorPersona.toLocaleString()}/a√±o por persona.</p>
            <p style="margin-top:1rem; color:var(--text-light);">Detr√°s de cada n√∫mero hay familias reales, sue√±os destruidos, futuros cancelados.</p>`;
        } else {
            mensaje = `<p>Se acabaron las medidas, ${estado.playerName}. Llegaste a $${estado.ganancias.toFixed(1)}B de $${META_GANANCIAS}B.</p>
            <p style="color:var(--primary);">Pero ${trabajadoresAfectados.toLocaleString()} trabajadores ya pagaron el costo de tu experimento.</p>
            <p>La reforma no alcanz√≥ para cumplir tus sue√±os de derrame, pero s√≠ alcanz√≥ para destruir miles de vidas.</p>
            <p style="color:var(--accent); margin-top:1rem;">Pero tranquilo, siempre pueden inventar m√°s "modernizaciones"... üìú</p>`;
        }
    }
    
    document.getElementById('modal-icon').textContent = icon;
    document.getElementById('modal-title').textContent = title;
    document.getElementById('modal-title').style.color = tipo === 'victoria' ? 'var(--gold)' : 'var(--primary)';
    document.getElementById('modal-subtitle').textContent = subtitle;
    document.getElementById('modal-message').innerHTML = mensaje;
    
    modal.classList.add('active');
}

function reiniciarJuego() {
    playSound('click');
    stopMusic();
    document.getElementById('modal-overlay').classList.remove('active');
    showScreen('inicio');
}
</script>

<footer>
    <div class="container">
        <div class="footer-content">
            <!-- Foto de perfil -->
            <div class="profile-photo">
                <img src="Yo.jpeg" alt="Leandro Monk">
            </div>
            
            <!-- Informaci√≥n de contacto -->
            <div class="contact-info">
                <h3>Leandro Monk</h3>
                <p class="bio">
                    Fundador de <a href="https://gcoop.coop" target="_blank" style="color: var(--accent);">gcoop</a>, primera cooperativa de software libre de Argentina. 
                    Presidente de <a href="https://mit.org.ar" target="_blank" style="color: var(--accent);">MIT.</a> 
                    Especialista en tecnolog√≠a cooperativa, soberan√≠a tecnol√≥gica y econom√≠a social.
                </p>
                
                <!-- Redes sociales -->
                <div class="social-links">
                    <a href="https://x.com/leitomonk" target="_blank">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                        @leitomonk
                    </a>
                    <a href="https://www.linkedin.com/in/leandromonk/" target="_blank">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                        LinkedIn
                    </a>
                    <a href="https://github.com/leito-monk" target="_blank">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                        GitHub
                    </a>
                    <a href="mailto:leandro@gcoop.coop">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                        Contacto
                    </a>
                </div>
            </div>
            
            <!-- Nota final -->
            <div class="footer-note">
                <p><strong>Serie: Reforma Laboral Argentina</strong></p>
                <p style="margin-top: 0.5rem;">
                    <a href="analisis-transferencia-trabajadores.html" target="_blank">Parte I: An√°lisis de Retrocesos</a> ¬∑ 
                    <a href="analisis-costo-fiscal-v6.html" target="_blank">Parte II: An√°lisis del Costo Fiscal</a>
                </p>
                <p style="margin-top: 1rem;">An√°lisis elaborado como ejercicio de transparencia y debate p√∫blico</p>
                <p style="margin-top: 0.5rem;">Documentos colaborativos abiertos a correcciones y mejoras</p>
                <p style="margin-top: 1rem; font-size: 0.8rem; opacity: 0.7;">Diciembre 2025</p>
            </div>
        </div>
    </div>
</footer>

</body>
</html>
